name: "C.A.D.S.O.K. Apps"

services:
  # ðŸ¤– CRAWLER MICROSERVICES ðŸ¤–
  url-discovery:
    image: crawler-url-discovery
    container_name: crawler-url-discovery
    ports:
      - "${DISCOVERY_PORT:-8081}:8081"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - KAFKA_BOOTSTRAP_SERVERS=kafka1:19092,kafka2:19093,kafka3:19094
    networks:
      - cadsok_default

  processor:
    image: crawler-processor
    container_name: crawler-processor
    ports:
      - "${PROCESSOR_PORT:-8083}:8083"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - DB_HOST=crawler-pg-db
      - DB_PORT=5432
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_NAME=${DB_NAME}
      - KAFKA_BOOTSTRAP_SERVERS=kafka1:19092,kafka2:19093,kafka3:19094
      - REDIS_HOST=crawler-cache-redis
      - REDIS_PORT=6379
      - REDIS_CACHE_TTL=${REDIS_CACHE_TTL}
    networks:
      - cadsok_default

  fetcher:
    image: crawler-fetcher
    container_name: crawler-fetcher
    ports:
      - "${FETCHER_PORT:-8082}:8082"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - KAFKA_BOOTSTRAP_SERVERS=kafka1:19092,kafka2:19093,kafka3:19094
      - PARSER_URL=http://parser:8084/api/v1/parser/process
      - SENSOR_URL=http://sensor:8085/api/v1/sensor/inspect
    networks:
      - cadsok_default

  parser:
    image: crawler-parser
    container_name: crawler-parser
    ports:
      - "${PARSER_PORT:-8084}:8084"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - PARSER_FAIL_RATE=${PARSER_FAIL_RATE}
    networks:
      - cadsok_default

  sensor:
    image: crawler-sensor
    container_name: crawler-sensor
    ports:
      - "${SENSOR_PORT:-8085}:8085"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - SENSOR_FAIL_RATE=${SENSOR_FAIL_RATE}
    networks:
      - cadsok_default

networks:
  cadsok_default:
    external: true
